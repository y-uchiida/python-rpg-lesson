# 開発パート04: 戦闘中のコマンド選択機能を実装する  

ここまでは、戦闘が開始したら、敵キャラクターか味方キャラクターが全滅するまで自動で処理が進むようになっていました。  
ゲームとしての完成度を高めるために、戦闘中にもユーザーが操作を行える機能を追加していきましょう。

## 1. battle() 関数の改修

`battle()` 関数内に、以下のような処理を追加していきます。

1. 味方キャラクターと敵キャラクターが攻撃し終わったら、ユーザーにキーボードの入力を促す
2. 「1（たたかう）」が入力された場合は、もう1ターン戦闘を行う
3. 「2（にげる）」が入力された場合は、戦闘を終了する
4. 「3（交代）」が入力された場合は、味方キャラクターを交代する処理を行う
5. それ以外の値が入力された場合は、適切な値を入力するようにメッセージを表示する

条件分岐や場合分けが複雑になってきたので、処理フロー図を書いてみて、見通しを立ててみてください。  
以下、それぞれの分岐がどのような処理になればよいか、簡単に見ていきます。  

### 「1（たたかう）」の場合

この場合は、特に処理を行わず、戦闘が継続されればよいです。何もせずに、戦闘のループをもう1巡させる処理を作りましょう。

### 「2（にげる）」の場合

勝敗を決めずに、戦闘を終了させます。戦闘の処理のループから抜けられればよいでしょう。

### 「3（交代）」の場合

味方キャラクターの交代を行うメソッドを作成して、それを実行した後に戦闘のループを継続するようにしてみましょう。  
戦闘を行うのは、味方キャラクターの一覧の最初にいるキャラクターという決まりにしていました。そのため、1番目にいるキャラクターと、2番目以降のキャラクターをリストの中で入れ替えるというプログラムを書けばよいです。  

味方キャラクターの一覧はlistで作成しているので、listで利用できる記法を調べてみて、実装方法を考えてみてください。

:::info
入れ替えの方法は一つではありませんので、いろいろ調べてみましょう
:::

## 2. 動作の確認

1～3までの処理が作れたら、動作に問題がないかを確かめていきます。  
今回は戦闘のループの中を変更しただけですので、1～3のコマンドをいろいろ組み合わせて実行して、問題が起こらないか試してみましょう。
